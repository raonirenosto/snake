
<canvas id="gc"></canvas>

<script>
    screenHeight = 600;
    screenWidth = 600;
    matrixSize = 16
    polygon = screenHeight / matrixSize
    canv=document.getElementById("gc");
    ctx=canv.getContext("2d");
    canv.height = screenHeight;
    canv.width = screenWidth;
    trail = 6;
    xSnake = polygon * (matrixSize / 2)
    ySnake = screenHeight - (polygon * 3)
    snake = []
    applePositionX = 0;
    applePositionY = 0;
    x = -polygon;
    y = +0;

    window.onload=function() {
        setInterval(game,1000/15);

        startGame();

        document.addEventListener("keydown",keyPush);
    }

    function game() {

        ctx.fillStyle="black";
        ctx.fillRect(0,0,screenHeight,screenWidth);

        ctx.fillStyle="red";
        ctx.fillRect(applePositionX, applePositionY, polygon, polygon);

        ctx.fillStyle="lime";

        for (i=0; i<snake.length; i++) {

          printSnake(snake[i].x, snake[i].y);

          if (snake[i].x < 0) {
            snake[i].x = (matrixSize - 1) * polygon
          }
          if (snake[i].x > screenWidth) {
            snake[i].x = 0
          }
          if (snake[i].y < 0) {
            snake[i].y = (matrixSize - 1) * polygon
          }
          if (snake[i].y > screenHeight) {
            snake[i].y = 0
          }
        }

        snake.unshift({x: snake[0].x + x, y: snake[0].y + y})
        snake.pop();

        if ( ((snake[0].x / matrixSize) == (applePositionX / matrixSize)) &&
          ((snake[0].y / matrixSize) == (applePositionY / matrixSize))
        ) {
          snake.unshift({x: snake[0].x + x, y: snake[0].y + y})
          drawApple();
        }

        detectColision()
    }

    function keyPush(evt) {
      x=0;
      y=0;
      switch(evt.keyCode) {
          case 37:
              x = -polygon
              break;
          case 38:
              y = -polygon
              break;
          case 39:
              x = +polygon
              break;
          case 40:
              y = +polygon
              break;
      }
  }

  function startGame() {
    snake = []
    for (i=0; i<trail; i++) {
        snake.push({x: xSnake + (polygon * i), y: ySnake})
    }
    drawApple();
  }

  function drawApple() {
    applePositionX = Math.floor(Math.random() * (matrixSize - 1)) + 0
    applePositionY = Math.floor(Math.random() * (matrixSize - 1)) + 0
    applePositionX = applePositionX * polygon
    applePositionY = applePositionY * polygon
  }

  function detectColision() {
    for (i=0; i<snake.length; i++) {
      for (p=0; p<snake.length; p++) {
        if (i == p) {
          break;
        }

        if (snake[i].x == snake[p].x &&
            snake[i].y == snake[p].y){
          startGame();
        }
      }
    }
  }

  function printSnake(x, y) {
    ctx.fillRect( x, y, polygon, polygon);
  }
</script>
